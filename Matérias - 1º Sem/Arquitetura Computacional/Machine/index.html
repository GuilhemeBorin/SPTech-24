<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Calculadora</title>
</head>

<body>
    <div class="containerMae">
        <h2 class="title">CONVERTION'S <span style="color: #15672e; font-family: Verdana, Geneva, Tahoma, sans-serif; font-weight: 600;">MACHINE</span></h2>
        <div class="containerFilhos">
            <!-- Container principal que guarda o container da esquerda(Inputs e bot√£o) e da direita(Resposta) -->
            <div class="containerFilho1"> <!-- Container da esquerda, contendo Inputs e bot√£o -->

                <div class="conteudo">
                    <span style="font-size: 17px;">Informe um n√∫mero</span>
                    <input type="text" id="input_valorDesejado" placeholder="Digite o valor desejado">
                </div>

                <div class="conteudo">
                    <span style="font-size: 17px;">Selecione a base para a convers√£o</span>
                    <select id="select_baseConversao">
                        <option value="binario">Bin√°rio</option> 
                        <option value="decimal">Decimal</option>
                        <option value="octal">Octal</option>
                        <option value="hexadecimal">Hexadecimal</option>
                    </select>
                </div>

                <span style="font-size: 17px;">Selecione as bases nas quais gostaria de ver a convers√£o:</span>
                <div class="conteudo">
                    <input style="margin-top: 10px;" id="convertBinario" onclick="aparecer_octal()" type="checkbox">
                    <label for="convertBinario">Bin√°rio</label>
                    <br>
                    <input id="convertDecimal" onclick="aparecer_hexa()" type="checkbox">
                    <label for="convertDecimal">Decimal</label>
                    <br>
                    <input id="convertOctal" onclick="aparecer_bin()" type="checkbox">
                    <label for="convertOctal">Octal</label>
                    <br>
                    <input id="convertHexadecimal" onclick="aparecer_bin()" type="checkbox">
                    <label for="convertHexadecimal">Hexadecimal</label>
                    <br>
                    <p id="btn"><button onclick="Converter()" class="button">CONVERTER</button></p>
                </div>
            </div>
            <div class="containerFilho2">
                <!-- Container da direita, cont√©m a imagem at√© que o usu√°rio clique no bot√£o, ao clicar, a imagem √© oculta e aparece a resposta -->
                <img src="Binary2.png" id="imagem"> <!-- Imagem antes do usu√°rio clicar no bot√£o -->
                <div id="show"></div> <!-- div que ser√° puxada pelo innerHTML, para que apare√ßa a resposta -->
            </div>
        </div>
    </div>


    <!-- Div do Pop Up -->
    <div id="myPopUp" class="modal"> <!-- modal √© a classe para Pop Up-->
        <div class="containerPopUp">
            <span class="close">&times;</span>
            <p> <h2>Ol√°, Bem Vindo(a) a Convertion¬¥s Machine!üòÑ</h2>
                <br>
                <span style="font-family: Verdana, Geneva, Tahoma, sans-serif;"> Voc√™ j√° se encontrou atolado(a) em uma montanha de dados, tentando encontrar uma maneira de transform√°-los em algo √∫til e compreens√≠vel? </span> <br><br>
                 <h4>üí° Na Convertion's Machine, simplificamos esse processo para voc√™ de forma mais simples e moderna!</h4>
            </p>
        </div>
    </div>
</body>

</html>
<script>
    function Converter() {
        let inputValue = document.getElementById('input_valorDesejado').value;
        let inputBase = document.getElementById('select_baseConversao').value;
    
        let checkBin = convertBinario.checked
        let checkDec = convertDecimal.checked
        let checkOct = convertOctal.checked
        let checkHex = convertHexadecimal.checked

        if (inputValue.trim() === '') {
        alert('Por favor, preencha os campos.');
        return;
        }
        else if(checkBin == false && checkDec == false  && checkOct == false  && checkHex == false){
            alert ("Por favor, selecione uma ou mais bases em que deseja visualizar o resultado.")
                return true; // faz com que a imagem n√£o desapare√ßa ap√≥s o alert
        }

        if (!validarEntrada(inputValue, inputBase)) {
            alert('Por favor, insira um n√∫mero v√°lido para a base selecionada.');
            return;
        }
    
        let decimalValue = parseInt(inputValue, inputBase === 'hexadecimal' ? 16 : inputBase === 'octal' ? 8 : inputBase === 'binario' ? 2 : 10);
        let outputHTML = '';

        if (document.getElementById('convertDecimal').checked) {
            document.getElementById('show').style.display = 'block';
            outputHTML += `<p style="font-family: Verdana, Geneva, Tahoma, sans-serif; padding: 15px; background-color: #36615f; margin: 10px; border-radius: 10px; font-size: 15px;">Decimal: ${decimalValue}</p>`;
        } 
        if (document.getElementById('convertHexadecimal').checked) {
            document.getElementById('show').style.display = 'block';
            outputHTML += `<p style="font-family: Verdana, Geneva, Tahoma, sans-serif; padding: 15px; background-color: #15672e; margin: 10px; border-radius: 10px; font-size: 15px;">Hexadecimal: ${decimalValue.toString(16).toUpperCase()}</p>`;
        }
        if (document.getElementById('convertOctal').checked) {
            document.getElementById('show').style.display = 'block';
            outputHTML += `<p style="font-family: Verdana, Geneva, Tahoma, sans-serif; padding: 15px; background-color: #36615f; margin: 10px; border-radius: 10px; font-size: 15px;">Octal: ${decimalValue.toString(8)}</p>`;
        }
        if (document.getElementById('convertBinario').checked) {
            document.getElementById('show').style.display = 'block';
            outputHTML += `<p style="font-family: Verdana, Geneva, Tahoma, sans-serif; padding: 15px; background-color: #15672e; margin: 10px; border-radius: 10px; font-size: 15px;">Bin√°rio: ${decimalValue.toString(2)}</p>`;
        }
        show.innerHTML = outputHTML;
          

        function validarEntrada(inputValue, inputBase) {

            var validChars = '';

            if (inputBase === 'decimal') {
                validChars = '0123456789';
            } else if (inputBase === 'hexadecimal') {
                validChars = '0123456789ABCDEFabcdef';
            } else if (inputBase === 'octal') {
                validChars = '01234567';
            } else if (inputBase === 'binario') {
                validChars = '01';
            }

            for (var i = 0; i < inputValue.length; i++) {
                if (validChars.indexOf(inputValue[i]) === -1) {
                    return false;
                }
            }
            if (imagem.hidden = true) {
                return true;
            }
        }

    }

    // ---------- POP UP ----------

    // Pega o modal
    var modal = document.getElementById("myPopUp");

    // Pega o bot√£o que fecha o modal
    var closeBtn = document.getElementsByClassName("close")[0];

    // Mostra o modal quando a p√°gina √© carregada
    window.onload = function () {
        modal.style.display = "block";
    }

    // Fecha o modal quando o usu√°rio clica no bot√£o de fechar
    closeBtn.onclick = function () {
        modal.style.display = "none";
    }

    // Fecha o modal quando o usu√°rio clica fora dele
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
</script>


<!-- 
<!--
ARDUINO
int pinoSensor = 7;
const int LM35 = A5; // Define o pino que lera a sa√≠da do LM35
float temperatura; // Vari√°vel que armazenar√° a temperatura medida

void setup() {
  pinMode(pinoSensor, INPUT);
  Serial.begin(9600);
}
 
 

void loop() {
  if(digitalRead(pinoSensor) == LOW){
  Serial.print(1);
  }
  else {
  Serial.print(0);
  }
  Serial.print(';');
  temperatura = (float(analogRead(LM35))*5/(1023))/0.01;
  Serial.println(temperatura);
  delay(2000);
}


API
// Importa os m√≥dulos necess√°rios
// n√£o altere!
const serialport = require('serialport'); // M√≥dulo para comunica√ß√£o serial
const express = require('express'); // M√≥dulo para criar um servidor web
const mysql = require('mysql2'); // M√≥dulo para conectar ao MySQL

// Constantes para configura√ß√µes
// n√£o altere!
const SERIAL_BAUD_RATE = 9600;
const SERVIDOR_PORTA = 3300;

// Habilita ou desabilita a inser√ß√£o de dados no banco de dados
// false -> nao insere
// true -> insere
const HABILITAR_OPERACAO_INSERIR = true;

// Fun√ß√£o para comunica√ß√£o serial
const serial = async (
    valoresLm35Temperatura,
    valoresChave
) => {
    let poolBancoDados = ''

    // Conex√£o com o banco de dados MySQL
    poolBancoDados = mysql.createPool(
        {
            // altere!
            // Credenciais do banco de dados
            host: 'localhost',
            user: 'XXXXXX',
            password: '#XXXXXX',
            database: 'arduino',
            port: 3306
        }
    ).promise();

    // Lista as portas seriais dispon√≠veis e procura pelo Arduino
    const portas = await serialport.SerialPort.list();
    const portaArduino = portas.find((porta) => porta.vendorId == 2341 && porta.productId == 43);
    if (!portaArduino) {
        throw new Error('O arduino n√£o foi encontrado em nenhuma porta serial');
    }

    // Configura a porta serial com o baud rate especificado
    const arduino = new serialport.SerialPort(
        {
            path: portaArduino.path,
            baudRate: SERIAL_BAUD_RATE
        }
    );

    // Evento quando a porta serial √© aberta
    arduino.on('open', () => {
        console.log(A leitura do arduino foi iniciada na porta $ {portaArduino.path} utilizando Baud Rate de $ {SERIAL_BAUD_RATE});
    });

    // Processa os dados recebidos do Arduino
    arduino.pipe(new serialport.ReadlineParser({ delimiter: '\r\n' })).on('data', async (data) => {
        const valores = data.split(';');
        const chave = parseInt(valores[0]);
        const lm35Temperatura = parseFloat(valores[1]);


        // Armazena os valores dos sensores nos arrays correspondentes
        valoresLm35Temperatura.push(lm35Temperatura);
        valoresChave.push(chave);

        // Insere os dados no banco de dados (se habilitado)
        if (HABILITAR_OPERACAO_INSERIR) {

            // altere!
            // Este insert ir√° inserir os dados na tabela "medida"
            await poolBancoDados.execute(
                'INSERT INTO temperatura_bloqueio (lm35_temperatura, chave) VALUES (?, ?)',
                [lm35Temperatura, chave]
               
            );
           
            console.log("valores inseridos no banco: " + chave + ", " + lm35Temperatura)
       
        }
       
    });

    // Evento para lidar com erros na comunica√ß√£o serial
    arduino.on('error', (mensagem) => {
        console.error(Erro no arduino (Mensagem: $ {mensagem})
    });
}


// n√£o altere!
// Fun√ß√£o para criar e configurar o servidor web
const servidor = (
    valoresLm35Temperatura,
    valoresChave
) => {
    const app = express();

    // Configura√ß√µes de CORS
    app.use((request, response, next) => {
        response.header('Access-Control-Allow-Origin', '*');
        response.header('Access-Control-Allow-Headers', 'Origin, Content-Type, Accept');
        next();
    });

    // Inicia o servidor na porta especificada
    app.listen(SERVIDOR_PORTA, () => {
        console.log(API executada com sucesso na porta $ {SERVIDOR_PORTA});
    });

    // Define os endpoints da API para cada tipo de sensor
    app.get('/sensores/lm35/temperatura', (_, response) => {
        return response.json(valoresLm35Temperatura);
    });
    app.get('/sensores/chave', (_, response) => {
        return response.json(valoresChave);
    });
}

// Fun√ß√£o principal ass√≠ncrona para iniciar a comunica√ß√£o serial e o servidor web
(async () => {
    const valoresLm35Temperatura = [];
    const valoresChave = [];

    // Inicia a comunica√ß√£o serial
    await serial(
        valoresLm35Temperatura,
        valoresChave
    );

    // Inicia o servidor web
    servidor(
        valoresLm35Temperatura,
        valoresChave
    );
})();


AVALIATIVA
Qual √© a distin√ß√£o entre as portas 3300 e 3306?

Enquanto a porta 3300 pode ser aplicada em diferentes servi√ßos, ela tem a finalidade de hospedar os dados da API, a porta 3306 √© um porta padr√£o para comunica√ß√£o dos servi√ßos MySQL, consultando e manipulando dados
 
No index.html, como √© feita a chamada √† API externa chart.js? Onde √© realizada essa chamada e onde um novo gr√°fico √© criado?

Dentro da tag ‚Äòhead‚Äô √© feito a importa√ß√£o da biblioteca do chart.js, logo ap√≥s √© adicionado a tag ‚Äòcanvas‚Äô dentro da tag ‚Äòbody‚Äô, sendo definido onde os gr√°ficos ser√£o gerados, por fim definindo dentro de uma tag ‚Äòscript‚Äô as configura√ß√µes, valores da tabela e renderiza√ß√£o do gr√°fico  

Onde √© poss√≠vel ajustar o tamanho e o tipo de gr√°fico gerado?

Dentro da variavel do sensor na tag script, voc√™ adiciona o tipo de gr√°fico por meio do comando new Chart, logo ap√≥s definindo colunas, cores, tamanhos do eixo x e y, al√©m da visualiza√ß√£o dos dados do gr√°fico

O que √© representado pelo m√©todo 'get' no c√≥digo main.js?

Por esse comando, √© definido o endpoint de cada tipo de sensor na API, pegando os dados dos sensores e sendo retornado o valor em json

 

Por que √© gerado um arquivo JSON e para que ele √© utilizado?

Arquivos json s√£o utilizados para exportar informa√ß√µes em texto armazenados para outras aplica√ß√µes web como o MySQL, sendo categorizado e organizado de uma maneira mais uniforme e leve

 

Considerando que no c√≥digo.ino a sa√≠da √©  

DHTH_temp; DHTH_umid; Luminosidade; LM35_temp; chave, explique como essa estrutura de dados (na forma de lista) √© adicionada como um vetor na APINode. Demonstre como o c√≥digo captura essa lista e a divide ordenadamente dentro de um vetor.

Os valores capturados pelo arduino s√£o armazenados pelo comando ‚Äò.push‚Äô e divididos pelo split com um (‚Äò;‚Äô), onde os dados s√£o separados e criando diferentes listas
-->

 -->